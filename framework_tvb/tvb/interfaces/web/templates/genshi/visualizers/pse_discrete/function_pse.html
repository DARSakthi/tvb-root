<py:def function="generateFramePSE(dataTypeGroupGID, available_metrics)" xmlns:py="http://genshi.edgewall.org/">
    <script type="text/javascript" src="/static/js/d3.v3.js"></script>
<script type="text/javascript" src="/static/flot/jquery.flot.js"></script>
<script type="text/javascript" src="/static/flot/jquery.flot.symbol.js"></script>
<script type="text/javascript" src="/static/coloring/colorSchemeComponent.js"></script>

<!--! Controls for changing metrics -->
<ul class="toolbar-inline burst-pse-metrics">
	<li>
		<label for="color_metric_select">Color metric</label>
		<select id="color_metric_select">
			<option value="None">None</option>
			<py:for each="metric in available_metrics">
			<py:if test="metric==color_metric">
			<option value="$metric" selected="selected">$metric</option>
			</py:if>
			<py:if test="metric!=color_metric">
			<option value="$metric">$metric</option>
			</py:if>
			</py:for>
		</select>
	</li>

	<li>
		<label for="size_metric_select">Size metric</label>
		<select id="size_metric_select">
			<option value="None">None</option>
			<py:for each="metric in available_metrics">
			<py:if test="metric==size_metric">
			<option value="$metric" selected="selected">$metric</option>
			</py:if>
			<py:if test="metric!=size_metric">
			<option value="$metric">$metric</option>
			</py:if>
			</py:for>
		</select>
	</li>

	<li>
		<a href="#" onclick="PSE_mainDraw('main_div_pse', '${pse_back_page}')" title="Refresh..." class="action action-refresh">Refresh</a>
	</li>
    <li>
        <button id="Explore">Explore</button>
    </li>
    <li>
        <button id="Cursor">Cursor</button>
    </li>
    <li>
        <button id="Magnify">Magnify</button>
    </li>
    <li>
        <button id="Hand">Hand</button>
    </li>
    <li>
        <button id="Filter">Filter</button>
    </li>
</ul>

<!--! Controls for displaying MAX / MIN values -->
<ul class="toolbar-inline burst-pse-colors">
	<li>
		<label><mark>Minimum color metric</mark> <span id="minColorLabel"></span> </label>
	</li>
	<li>
		<label><mark>Maximum color metric</mark> <span id="maxColorLabel"></span> </label>
	</li>
	<li>
		<label><mark>Minimum shape metric</mark> <span id="minShapeLabel"></span> </label>
	</li>
	<li>
		<label><mark>Maximum shape metric</mark> <span id="maxShapeLabel"></span> </label>
	</li>
	<li>
		<label class="pse-graph-title"><mark>axis Y - axis X</mark> $title_y  -  $title_x</label>
	</li>
</ul>

    <!--! this is what will become visible upon selecting an canvas area for exploration -->
    <div id="Exploretooltip" class="hidden">
        <div xmlns:py="http://genshi.edgewall.org/" py:strip="True">

            <py:def function="draw_number_component(inputRow, disabled, parentDivId)">
                <!--! Draw Input field for a number  (input text). -->
                <input type="text" tabindex='1' name="$inputRow.name" id="$inputRow.name"
                       value="${inputRow.default if ('default' in inputRow) else ''}"
                       readonly="${'readonly' if 'locked' in inputRow and inputRow.locked else None}"
                       disabled="${'disabled' if disabled else None}"/>

                ${drawRangeComponent(inputRow, parentDivId)}
            </py:def>


            <py:def function="drawRangeComponent(inputRow, parentDivId)">
                <!--!    Function to generate the UI component for a Range parameter. (for FLOAT/INT/ARRAY attributes) -->
                <py:if test="'minValue' in inputRow and 'maxValue' in inputRow and 'stepValue' in inputRow and not param_checkbox_config">
                    <py:with vars="containerDivId=parentDivId+inputRow.name + '_RANGER';
                       minValue=float(inputRow.minValue);maxValue=float(inputRow.maxValue);stepValue=float(inputRow.stepValue)">
                        <table id="${containerDivId}" class="ranger-div-class" style="display: none;">
                            <tr>
                                <td><label>Available Interval:</label></td>
                                <td><span id='${containerDivId}_interval_span' class="ranger-value">${minValue} - ${maxValue}</span>
                                </td>
                            </tr>
                            <tr>
                                <td><label>Current Selected Range:</label></td>
                                <td><input type="number" step="0.0001" min="${minValue}" max="${maxValue}"
                                           id="${containerDivId}_FromIdx"/>
                                    <input type="number" step="0.0001" min="${minValue}" max="${maxValue}"
                                           id="${containerDivId}_ToIdx"/></td>
                            </tr>
                            <tr>
                                <td><label for='${containerDivId}_stepInput'
                                           title='The step used for the range'>Step:</label></td>
                                <td><input type='number' id='${containerDivId}_stepInput' value='${stepValue}' min="0"
                                           max="${maxValue - minValue}" step="0.0001"
                                           title='The step used for the range' tabindex="1" disabled="disabled"/></td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <div id='${containerDivId}_slider'></div>
                                    <input id='${containerDivId}_hidden' type='hidden' name='${inputRow.name}'
                                           disabled="disabled"/>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" id="${containerDivId}_rangeLabelsTd"></td>
                            </tr>
                        </table>
                        <p class="field-adapters">
                            <input tabindex='1' type="button" class="ranger-button right-display"
                                   value="Expand Range" id="${containerDivId}_buttonExpand"
                                   title="Toggle Range for current parameter. This will launch multiple simulations!"
                                   onclick="toggleRange('$containerDivId', ${minValue}, ${maxValue}, ${stepValue}, '${inputRow.name}');"/>
                        </p>
                    </py:with>
                </py:if>
            </py:def>
            ${draw_number_component({'name':"slider", 'minValue':0, 'maxValue':10,'stepValue':
            0.001},False,"#Exploretooltip")}
        </div>

    </div>

<input type="hidden" id="datatype-group-gid" value="$dataTypeGroupGID"/>

<!--! Here PSE bubles will be displayed.	-->
<div id="main_div_pse" class="specialviewer"></div>

<script type="text/javascript">
	$(document).ready(function() {
		PSEDiscreteInitialize('$labels_x', '$labels_y', '$series_array', '$data', '$pse_back_page',
							  $has_started_ops, '$min_color', '$max_color', '$min_shape_size', '$max_shape_size');
							  window.onresize = function() { redrawPlot('main_div_pse'); };
	});
</script>

</py:def>


